# Types and Definitions for Credentials

enum CredentialKind {
  PASSWORD
  KEY
  CERTIFICATE
}

type Credential implements Node {
  id: ID!
  principal: String!
  secret: String!
  kind: CredentialKind!

  target: Target!
}

enum CredentialOrderField {
  PRINCIPAL
  SECRET
  KIND
}

input CredentialOrder {
  direction: OrderDirection!
  field: CredentialOrderField
}

type CredentialEdge {
  node: Credential
  cursor: Cursor!
}

type CredentialConnection {
  totalCount: Int!
  pageInfo: PageInfo!
  edges: [CredentialEdge]
}
# Types and Definitions for Deployments

type DeploymentConfig implements Node {
  id: ID!
  name: String!
  cmd: String
  startCmd: Boolean!
  fileDst: String 

  implantConfig: ImplantConfig
  file: File

  deployments: [Deployment!]
}

type Deployment implements Node {
  id: ID!
  output: String!
  error: String!
  queuedAt: Time!
  lastModifiedAt: Time!
  startedAt: Time
  finishedAt: Time

  target: Target!
  config: DeploymentConfig!
}"""
CredentialWhereInput is used for filtering Credential objects.
Input was generated by ent.
"""
input CredentialWhereInput {
  not: CredentialWhereInput
  and: [CredentialWhereInput!]
  or: [CredentialWhereInput!]
  
  """principal field predicates"""
  principal: String
  principalNEQ: String
  principalIn: [String!]
  principalNotIn: [String!]
  principalGT: String
  principalGTE: String
  principalLT: String
  principalLTE: String
  principalContains: String
  principalHasPrefix: String
  principalHasSuffix: String
  principalEqualFold: String
  principalContainsFold: String
  
  """secret field predicates"""
  secret: String
  secretNEQ: String
  secretIn: [String!]
  secretNotIn: [String!]
  secretGT: String
  secretGTE: String
  secretLT: String
  secretLTE: String
  secretContains: String
  secretHasPrefix: String
  secretHasSuffix: String
  secretEqualFold: String
  secretContainsFold: String
  
  """kind field predicates"""
  kind: CredentialKind
  kindNEQ: CredentialKind
  kindIn: [CredentialKind!]
  kindNotIn: [CredentialKind!]
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """target edge predicates"""
  hasTarget: Boolean
  hasTargetWith: [TargetWhereInput!]
}

"""
TargetWhereInput is used for filtering Target objects.
Input was generated by ent.
"""
input TargetWhereInput {
  not: TargetWhereInput
  and: [TargetWhereInput!]
  or: [TargetWhereInput!]
  
  """name field predicates"""
  name: String
  nameNEQ: String
  nameIn: [String!]
  nameNotIn: [String!]
  nameGT: String
  nameGTE: String
  nameLT: String
  nameLTE: String
  nameContains: String
  nameHasPrefix: String
  nameHasSuffix: String
  nameEqualFold: String
  nameContainsFold: String
  
  """forwardConnectIP field predicates"""
  forwardconnectip: String
  forwardconnectipNEQ: String
  forwardconnectipIn: [String!]
  forwardconnectipNotIn: [String!]
  forwardconnectipGT: String
  forwardconnectipGTE: String
  forwardconnectipLT: String
  forwardconnectipLTE: String
  forwardconnectipContains: String
  forwardconnectipHasPrefix: String
  forwardconnectipHasSuffix: String
  forwardconnectipEqualFold: String
  forwardconnectipContainsFold: String
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """credentials edge predicates"""
  hasCredentials: Boolean
  hasCredentialsWith: [CredentialWhereInput!]
  
  """implants edge predicates"""
  hasImplants: Boolean
  hasImplantsWith: [ImplantWhereInput!]
  
  """deployments edge predicates"""
  hasDeployments: Boolean
  hasDeploymentsWith: [DeploymentWhereInput!]
}

"""
FileWhereInput is used for filtering File objects.
Input was generated by ent.
"""
input FileWhereInput {
  not: FileWhereInput
  and: [FileWhereInput!]
  or: [FileWhereInput!]
  
  """name field predicates"""
  name: String
  nameNEQ: String
  nameIn: [String!]
  nameNotIn: [String!]
  nameGT: String
  nameGTE: String
  nameLT: String
  nameLTE: String
  nameContains: String
  nameHasPrefix: String
  nameHasSuffix: String
  nameEqualFold: String
  nameContainsFold: String
  
  """size field predicates"""
  size: Int
  sizeNEQ: Int
  sizeIn: [Int!]
  sizeNotIn: [Int!]
  sizeGT: Int
  sizeGTE: Int
  sizeLT: Int
  sizeLTE: Int
  
  """hash field predicates"""
  hash: String
  hashNEQ: String
  hashIn: [String!]
  hashNotIn: [String!]
  hashGT: String
  hashGTE: String
  hashLT: String
  hashLTE: String
  hashContains: String
  hashHasPrefix: String
  hashHasSuffix: String
  hashEqualFold: String
  hashContainsFold: String
  
  """createdAt field predicates"""
  createdat: Time
  createdatNEQ: Time
  createdatIn: [Time!]
  createdatNotIn: [Time!]
  createdatGT: Time
  createdatGTE: Time
  createdatLT: Time
  createdatLTE: Time
  
  """lastModifiedAt field predicates"""
  lastmodifiedat: Time
  lastmodifiedatNEQ: Time
  lastmodifiedatIn: [Time!]
  lastmodifiedatNotIn: [Time!]
  lastmodifiedatGT: Time
  lastmodifiedatGTE: Time
  lastmodifiedatLT: Time
  lastmodifiedatLTE: Time
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """deploymentConfigs edge predicates"""
  hasDeploymentConfigs: Boolean
  hasDeploymentConfigsWith: [DeploymentConfigWhereInput!]
}

"""
ImplantWhereInput is used for filtering Implant objects.
Input was generated by ent.
"""
input ImplantWhereInput {
  not: ImplantWhereInput
  and: [ImplantWhereInput!]
  or: [ImplantWhereInput!]
  
  """sessionID field predicates"""
  sessionid: String
  sessionidNEQ: String
  sessionidIn: [String!]
  sessionidNotIn: [String!]
  sessionidGT: String
  sessionidGTE: String
  sessionidLT: String
  sessionidLTE: String
  sessionidContains: String
  sessionidHasPrefix: String
  sessionidHasSuffix: String
  sessionidEqualFold: String
  sessionidContainsFold: String
  
  """processName field predicates"""
  processname: String
  processnameNEQ: String
  processnameIn: [String!]
  processnameNotIn: [String!]
  processnameGT: String
  processnameGTE: String
  processnameLT: String
  processnameLTE: String
  processnameContains: String
  processnameHasPrefix: String
  processnameHasSuffix: String
  processnameIsNil: Boolean
  processnameNotNil: Boolean
  processnameEqualFold: String
  processnameContainsFold: String
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """target edge predicates"""
  hasTarget: Boolean
  hasTargetWith: [TargetWhereInput!]
  
  """config edge predicates"""
  hasConfig: Boolean
  hasConfigWith: [ImplantConfigWhereInput!]
}

"""
ImplantCallbackConfigWhereInput is used for filtering ImplantCallbackConfig objects.
Input was generated by ent.
"""
input ImplantCallbackConfigWhereInput {
  not: ImplantCallbackConfigWhereInput
  and: [ImplantCallbackConfigWhereInput!]
  or: [ImplantCallbackConfigWhereInput!]
  
  """uri field predicates"""
  uri: String
  uriNEQ: String
  uriIn: [String!]
  uriNotIn: [String!]
  uriGT: String
  uriGTE: String
  uriLT: String
  uriLTE: String
  uriContains: String
  uriHasPrefix: String
  uriHasSuffix: String
  uriEqualFold: String
  uriContainsFold: String
  
  """proxyURI field predicates"""
  proxyuri: String
  proxyuriNEQ: String
  proxyuriIn: [String!]
  proxyuriNotIn: [String!]
  proxyuriGT: String
  proxyuriGTE: String
  proxyuriLT: String
  proxyuriLTE: String
  proxyuriContains: String
  proxyuriHasPrefix: String
  proxyuriHasSuffix: String
  proxyuriIsNil: Boolean
  proxyuriNotNil: Boolean
  proxyuriEqualFold: String
  proxyuriContainsFold: String
  
  """priority field predicates"""
  priority: Int
  priorityNEQ: Int
  priorityIn: [Int!]
  priorityNotIn: [Int!]
  priorityGT: Int
  priorityGTE: Int
  priorityLT: Int
  priorityLTE: Int
  
  """timeout field predicates"""
  timeout: Int
  timeoutNEQ: Int
  timeoutIn: [Int!]
  timeoutNotIn: [Int!]
  timeoutGT: Int
  timeoutGTE: Int
  timeoutLT: Int
  timeoutLTE: Int
  
  """interval field predicates"""
  interval: Int
  intervalNEQ: Int
  intervalIn: [Int!]
  intervalNotIn: [Int!]
  intervalGT: Int
  intervalGTE: Int
  intervalLT: Int
  intervalLTE: Int
  
  """jitter field predicates"""
  jitter: Int
  jitterNEQ: Int
  jitterIn: [Int!]
  jitterNotIn: [Int!]
  jitterGT: Int
  jitterGTE: Int
  jitterLT: Int
  jitterLTE: Int
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """implantConfigs edge predicates"""
  hasImplantConfigs: Boolean
  hasImplantConfigsWith: [ImplantConfigWhereInput!]
}

"""
ImplantConfigWhereInput is used for filtering ImplantConfig objects.
Input was generated by ent.
"""
input ImplantConfigWhereInput {
  not: ImplantConfigWhereInput
  and: [ImplantConfigWhereInput!]
  or: [ImplantConfigWhereInput!]
  
  """name field predicates"""
  name: String
  nameNEQ: String
  nameIn: [String!]
  nameNotIn: [String!]
  nameGT: String
  nameGTE: String
  nameLT: String
  nameLTE: String
  nameContains: String
  nameHasPrefix: String
  nameHasSuffix: String
  nameEqualFold: String
  nameContainsFold: String
  
  """authToken field predicates"""
  authtoken: String
  authtokenNEQ: String
  authtokenIn: [String!]
  authtokenNotIn: [String!]
  authtokenGT: String
  authtokenGTE: String
  authtokenLT: String
  authtokenLTE: String
  authtokenContains: String
  authtokenHasPrefix: String
  authtokenHasSuffix: String
  authtokenEqualFold: String
  authtokenContainsFold: String
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """deploymentConfigs edge predicates"""
  hasDeploymentConfigs: Boolean
  hasDeploymentConfigsWith: [DeploymentConfigWhereInput!]
  
  """implants edge predicates"""
  hasImplants: Boolean
  hasImplantsWith: [ImplantWhereInput!]
  
  """serviceConfigs edge predicates"""
  hasServiceConfigs: Boolean
  hasServiceConfigsWith: [ImplantServiceConfigWhereInput!]
  
  """callbackConfigs edge predicates"""
  hasCallbackConfigs: Boolean
  hasCallbackConfigsWith: [ImplantCallbackConfigWhereInput!]
}

"""
ImplantServiceConfigWhereInput is used for filtering ImplantServiceConfig objects.
Input was generated by ent.
"""
input ImplantServiceConfigWhereInput {
  not: ImplantServiceConfigWhereInput
  and: [ImplantServiceConfigWhereInput!]
  or: [ImplantServiceConfigWhereInput!]
  
  """name field predicates"""
  name: String
  nameNEQ: String
  nameIn: [String!]
  nameNotIn: [String!]
  nameGT: String
  nameGTE: String
  nameLT: String
  nameLTE: String
  nameContains: String
  nameHasPrefix: String
  nameHasSuffix: String
  nameEqualFold: String
  nameContainsFold: String
  
  """description field predicates"""
  description: String
  descriptionNEQ: String
  descriptionIn: [String!]
  descriptionNotIn: [String!]
  descriptionGT: String
  descriptionGTE: String
  descriptionLT: String
  descriptionLTE: String
  descriptionContains: String
  descriptionHasPrefix: String
  descriptionHasSuffix: String
  descriptionEqualFold: String
  descriptionContainsFold: String
  
  """executablePath field predicates"""
  executablepath: String
  executablepathNEQ: String
  executablepathIn: [String!]
  executablepathNotIn: [String!]
  executablepathGT: String
  executablepathGTE: String
  executablepathLT: String
  executablepathLTE: String
  executablepathContains: String
  executablepathHasPrefix: String
  executablepathHasSuffix: String
  executablepathEqualFold: String
  executablepathContainsFold: String
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """implantConfigs edge predicates"""
  hasImplantConfigs: Boolean
  hasImplantConfigsWith: [ImplantConfigWhereInput!]
}

"""
DeploymentWhereInput is used for filtering Deployment objects.
Input was generated by ent.
"""
input DeploymentWhereInput {
  not: DeploymentWhereInput
  and: [DeploymentWhereInput!]
  or: [DeploymentWhereInput!]
  
  """output field predicates"""
  output: String
  outputNEQ: String
  outputIn: [String!]
  outputNotIn: [String!]
  outputGT: String
  outputGTE: String
  outputLT: String
  outputLTE: String
  outputContains: String
  outputHasPrefix: String
  outputHasSuffix: String
  outputEqualFold: String
  outputContainsFold: String
  
  """error field predicates"""
  error: String
  errorNEQ: String
  errorIn: [String!]
  errorNotIn: [String!]
  errorGT: String
  errorGTE: String
  errorLT: String
  errorLTE: String
  errorContains: String
  errorHasPrefix: String
  errorHasSuffix: String
  errorEqualFold: String
  errorContainsFold: String
  
  """queuedAt field predicates"""
  queuedat: Time
  queuedatNEQ: Time
  queuedatIn: [Time!]
  queuedatNotIn: [Time!]
  queuedatGT: Time
  queuedatGTE: Time
  queuedatLT: Time
  queuedatLTE: Time
  
  """lastModifiedAt field predicates"""
  lastmodifiedat: Time
  lastmodifiedatNEQ: Time
  lastmodifiedatIn: [Time!]
  lastmodifiedatNotIn: [Time!]
  lastmodifiedatGT: Time
  lastmodifiedatGTE: Time
  lastmodifiedatLT: Time
  lastmodifiedatLTE: Time
  
  """startedAt field predicates"""
  startedat: Time
  startedatNEQ: Time
  startedatIn: [Time!]
  startedatNotIn: [Time!]
  startedatGT: Time
  startedatGTE: Time
  startedatLT: Time
  startedatLTE: Time
  startedatIsNil: Boolean
  startedatNotNil: Boolean
  
  """finishedAt field predicates"""
  finishedat: Time
  finishedatNEQ: Time
  finishedatIn: [Time!]
  finishedatNotIn: [Time!]
  finishedatGT: Time
  finishedatGTE: Time
  finishedatLT: Time
  finishedatLTE: Time
  finishedatIsNil: Boolean
  finishedatNotNil: Boolean
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """config edge predicates"""
  hasConfig: Boolean
  hasConfigWith: [DeploymentConfigWhereInput!]
  
  """target edge predicates"""
  hasTarget: Boolean
  hasTargetWith: [TargetWhereInput!]
}

"""
DeploymentConfigWhereInput is used for filtering DeploymentConfig objects.
Input was generated by ent.
"""
input DeploymentConfigWhereInput {
  not: DeploymentConfigWhereInput
  and: [DeploymentConfigWhereInput!]
  or: [DeploymentConfigWhereInput!]
  
  """name field predicates"""
  name: String
  nameNEQ: String
  nameIn: [String!]
  nameNotIn: [String!]
  nameGT: String
  nameGTE: String
  nameLT: String
  nameLTE: String
  nameContains: String
  nameHasPrefix: String
  nameHasSuffix: String
  nameEqualFold: String
  nameContainsFold: String
  
  """cmd field predicates"""
  cmd: String
  cmdNEQ: String
  cmdIn: [String!]
  cmdNotIn: [String!]
  cmdGT: String
  cmdGTE: String
  cmdLT: String
  cmdLTE: String
  cmdContains: String
  cmdHasPrefix: String
  cmdHasSuffix: String
  cmdEqualFold: String
  cmdContainsFold: String
  
  """startCmd field predicates"""
  startcmd: Boolean
  startcmdNEQ: Boolean
  
  """fileDst field predicates"""
  filedst: String
  filedstNEQ: String
  filedstIn: [String!]
  filedstNotIn: [String!]
  filedstGT: String
  filedstGTE: String
  filedstLT: String
  filedstLTE: String
  filedstContains: String
  filedstHasPrefix: String
  filedstHasSuffix: String
  filedstEqualFold: String
  filedstContainsFold: String
  
  """id field predicates"""
  id: ID
  idNEQ: ID
  idIn: [ID!]
  idNotIn: [ID!]
  idGT: ID
  idGTE: ID
  idLT: ID
  idLTE: ID
  
  """deployments edge predicates"""
  hasDeployments: Boolean
  hasDeploymentsWith: [DeploymentWhereInput!]
  
  """file edge predicates"""
  hasFile: Boolean
  hasFileWith: [FileWhereInput!]
  
  """implantConfig edge predicates"""
  hasImplantConfig: Boolean
  hasImplantConfigWith: [ImplantConfigWhereInput!]
}
# Types and Definitions for Files

type File implements Node {
  id: ID!
  name: String!
  size: Int!
  hash: String!
  createdAt: Time!
  lastModifiedAt: Time!
}

enum FileOrderField {
    NAME
    SIZE
    CREATED_AT
    LAST_MODIFIED_AT
}

input FileOrder {
  direction: OrderDirection!
  field: FileOrderField
}

type FileEdge {
  node: File
  cursor: Cursor!
}

type FileConnection {
  totalCount: Int!
  pageInfo: PageInfo!
  edges: [FileEdge]
}
type ImplantCallbackConfig implements Node {
    id: ID!
    uri: String!
    proxyURI: String
    priority: Int!
    timeout: Int!
    interval: Int!
    jitter: Int!
}

type ImplantServiceConfig implements Node {
    id: ID!
    name: String!
    description: String!
    executablePath: String!
}

type ImplantConfig implements Node {
  id: ID!
  name: String!
  authToken: String!

  serviceConfigs: [ImplantServiceConfig!]
  callbackConfigs: [ImplantCallbackConfig!]
}

type Implant implements Node {
  id: ID!
  sessionID: String!
  processName: String

  target: Target!
  config: ImplantConfig!
}

type CallbackResponse {
    implant: Implant!
}# Schema for all mutations that the Graph API supports.

type Mutation {
  callback(info: CallbackInput!): CallbackResponse!
  createImplantCallbackConfig(config: CreateImplantCallbackConfigInput!): ImplantCallbackConfig!
  updateImplantCallbackConfig(config: UpdateImplantCallbackConfigInput!): ImplantCallbackConfig!
  deleteImplantCallbackConfig(id: ID!): ID!
  createImplantServiceConfig(config: CreateImplantServiceConfigInput!): ImplantServiceConfig!
  updateImplantServiceConfig(config: UpdateImplantServiceConfigInput!): ImplantServiceConfig!
  deleteImplantServiceConfig(id: ID!): ID!
  createImplantConfig(config: CreateImplantConfigInput!): ImplantConfig!
  updateImplantConfig(config: UpdateImplantConfigInput!): ImplantConfig!
  deleteImplantConfig(id: ID!): ID!
  createTarget(target: CreateTargetInput!): Target!
  createCredential(credential: CreateCredentialInput!): Credential!
}

input CallbackInput {
  targetID: ID!
  sessionID: String!
  configName: String!
  processName: String!
}

input CreateImplantCallbackConfigInput {
    uri: String!
    proxyURI: String
    priority: Int
    timeout: Int
    interval: Int
    jitter: Int
}

input UpdateImplantCallbackConfigInput {
    id: ID!
    uri: String
    proxyURI: String
    priority: Int
    timeout: Int
    interval: Int
    jitter: Int
}

input CreateImplantServiceConfigInput {
    name: String!
    description: String
    executablePath: String!
}

input UpdateImplantServiceConfigInput {
    id: ID!
    name: String
    description: String
    executablePath: String
}

input CreateImplantConfigInput {
  name: String!

  serviceConfigIDs: [ID!]
  callbackConfigIDs: [ID!]
}

input UpdateImplantConfigInput {
    id: ID!
    name: String

    addServiceConfigIDs: [ID!]
    removeServiceConfigIDs: [ID!]

    addCallbackConfigIDs: [ID!]
    removeCallbackConfigIDs: [ID!]
}

input CreateTargetInput {
    name: String!
    forwardConnectIP: String!
}

input CreateCredentialInput {
    principal: String!
    secret: String!
    kind: CredentialKind!
    targetID: ID!
}

# Schema for all queries that the Graph API supports.

type Query {
  node(id: ID!): Node
  nodes(ids: [ID!]!): [Node]!
  targets(after: Cursor, first: Int, before: Cursor, last: Int, orderBy: TargetOrder, where: TargetWhereInput): TargetConnection
  credentials(after: Cursor, first: Int, before: Cursor, last: Int, orderBy: CredentialOrder, where: CredentialWhereInput): CredentialConnection
  files(after: Cursor, first: Int, before: Cursor, last: Int, orderBy: FileOrder, where: FileWhereInput): FileConnection
}# This schema has general types and definititions required by relay
# See https://relay.dev/graphql/connections.htm

interface Node {
  id: ID!
}

scalar Cursor

type PageInfo {
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: Cursor
  endCursor: Cursor
}

enum OrderDirection {
  ASC
  DESC
}# Types and Definitions for Targets

type Target implements Node {
  id: ID!
  name: String!
  forwardConnectIP: String!

  credentials: [Credential!]
  deployments: [Deployment!]
}

enum TargetOrderField {
  NAME
  FORWARD_CONNECT_IP
}

input TargetOrder {
  direction: OrderDirection!
  field: TargetOrderField
}

type TargetEdge {
  node: Target
  cursor: Cursor!
}

type TargetConnection {
  totalCount: Int!
  pageInfo: PageInfo!
  edges: [TargetEdge]
}
# Common Golang Type Definitions

scalar Time
