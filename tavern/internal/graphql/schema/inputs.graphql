input ClaimTasksInput {
  """The identity the beacon is authenticated as (e.g. 'root')"""
  principal: String!

  """The hostname of the system the beacon is running on."""
  hostname: String!

  """The platform the agent is operating on."""
  hostPlatform: HostPlatform!

  """The IP address of the hosts primary interface (if available)."""
  hostPrimaryIP: String

  """Unique identifier of the beacon, each running instance will be different."""
  beaconIdentifier: String!

  """Unique identifier of the underlying host system the beacon is running on."""
  hostIdentifier: String!

  """Name of the agent program the beacon is running as (e.g. 'imix')"""
  agentIdentifier: String!
}

input SubmitTaskResultInput {
  """ID of the task to submit results for."""
  taskID: ID!

  """Timestamp of when the task execution began. Format as RFC3339Nano."""
  execStartedAt: Time!

  """Timestamp of when the task execution finished (set only if it has completed). Format as RFC3339Nano."""
  execFinishedAt: Time

  """
  Output captured as the result of task execution.
  Submitting multiple outputs will result in appending new output to the previous output.
  """
  output: String!

  """Error message captured as the result of task execution failure."""
  error: String
}
input ImportRepositoryInput {
  """
  Optionally, specify directories to include.
  Only tomes that have a main.eldritch in one of these directory prefixes will be included.
  """
  includeDirs: [String!]
}

"""A single transport configuration for a build task."""
type BuildTaskTransport @goModel(model: "realm.pub/tavern/internal/builder/builderpb.BuildTaskTransport") {
  """The URI for the IMIX agent."""
  uri: String!

  """The callback interval in seconds."""
  interval: Int!

  """The transport type."""
  transportType: BeaconTransport_Type!

  """Extra transport configuration."""
  extra: String
}

"""Input for a single transport configuration."""
input BuildTaskTransportInput {
  """The URI for the IMIX agent."""
  uri: String!

  """The callback interval in seconds."""
  interval: Int! = 5

  """The transport type."""
  transportType: BeaconTransport_Type!

  """Extra transport configuration."""
  extra: String
}

"""Input for creating a new build task."""
input CreateBuildTaskInput {
  """The target operating system for the build."""
  targetOS: HostPlatform!

  """The output format for the build. Defaults to BIN."""
  targetFormat: BuildTaskTargetFormat

  """Docker container image name to use for the build. Defaults to spellshift/devcontainer:main."""
  buildImage: String

  """List of transport configurations. Defaults to a single gRPC transport at http://127.0.0.1:8000."""
  transports: [BuildTaskTransportInput!]

  """Path inside the build container to extract the artifact from. Defaults to the derived path based on target OS."""
  artifactPath: String
}

"""Output returned when registering a new builder."""
type RegisterBuilderOutput {
  """The created builder entity."""
  builder: Builder!

  """mTLS certificate PEM bundle for the builder to authenticate."""
  mtlsCert: String!

  """YAML-formatted configuration for the builder."""
  config: String!
}
