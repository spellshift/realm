syntax = "proto3";
// edition = "2024";

package portal;

option go_package = "realm.pub/tavern/internal/portal/portalpb";

message UDPMessage {
    bytes data = 1;
    string dst_addr = 2;
    uint32 dst_port = 3;
    uint32 src_port = 4;
}
message TCPMessage {
    bytes data = 1;
    string dst_addr = 2;
    uint32 dst_port = 3;
    uint32 src_port = 4;
}
enum BytesMessageKind {
    BYTES_MESSAGE_KIND_UNSPECIFIED = 0;
    BYTES_MESSAGE_KIND_DATA = 1;
    BYTES_MESSAGE_KIND_PING = 2;
}
message BytesMessage {
    bytes data = 1;
    BytesMessageKind kind = 2;
}

message Payload {
    oneof payload {
        UDPMessage udp = 1;
        TCPMessage tcp = 2;
        BytesMessage bytes = 3;
    }
}

message InvokePortalRequest {
    int64 portal_id = 1;
    Payload payload = 2;
}
message InvokePortalResponse {
    Payload payload = 2;
}

/*
 * Service
 */

service Portal {
    rpc InvokePortal(stream InvokePortalRequest) returns (stream InvokePortalResponse) {}
}
